{"keywords":{"scenario":false,"async":false,"export":true,"function":true,"algoprop":false},"tag":"866986381","params":"ctx\ntext\noptions\nfonts","when_created":1667540023.7925,"parent_id":"99e62b4e","props":[],"when_updated":1697120960.9701,"items":{"40":{"type":"action","id":"40","one":"27","text":"fonts[token.font] = true"},"31":{"type":"action","text":"block.width = Math.max(\n    calcLineWidth(line.tokens),\n    block.width\n)","one":"19","id":"31"},"5":{"flag1":0,"id":"5","type":"question","text":"options.singleLine","one":"36","two":"6"},"22":{"type":"loopend","text":"","one":"31","id":"22"},"32":{"type":"action","id":"32","one":"29","text":"block.width += (\n    options.paddingLeft + options.paddingRight\n)"},"23":{"type":"loopbegin","id":"23","one":"26","text":"token; line.tokens"},"7":{"type":"action","id":"7","one":"13","text":"lines = wrapInLineObjects([line])"},"33":{"type":"case","one":"9","id":"33"},"13":{"branchId":2,"one":"16","id":"13","type":"branch","text":"Set font"},"14":{"branchId":3,"one":"20","id":"14","type":"branch","text":"Branch1"},"34":{"one":"37","id":"34","type":"case","text":"\"markdown\"","two":"33"},"24":{"type":"action","text":"token.width = size.width","one":"22","id":"24"},"6":{"type":"action","id":"6","one":"7","text":"line = splitLineToTokens(text, \"\")"},"16":{"one":"15","id":"16","type":"action","text":"fontCache = initFontCache()","two":""},"35":{"one":"38","id":"35","type":"case","two":"34","text":"\"html\""},"25":{"type":"action","id":"25","one":"24","text":"size = ctx.measureText(token.text)"},"26":{"type":"action","id":"26","one":"39","text":"ctx.font = token.font"},"36":{"type":"select","id":"36","one":"35","text":"options.textFormat"},"27":{"flag1":0,"id":"27","type":"question","two":"28","one":"25","text":"token.type === \"space\""},"37":{"type":"action","text":"lines = splitToTokensMarkdown(text)","one":"13","id":"37"},"38":{"type":"action","text":"lines = splitToTokensHtml(text)","one":"13","id":"38"},"28":{"type":"action","id":"28","one":"24","text":"size = ctx.measureText(\" \")"},"39":{"flag1":1,"id":"39","type":"question","two":"27","one":"40","text":"token.font"},"29":{"type":"action","id":"29","one":"1","text":"return block"},"1":{"type":"end","id":"1"},"9":{"type":"action","text":"lines = wrapInLineObjects(\n    splitToTokens(text)\n)","one":"13","id":"9"},"18":{"type":"action","id":"18","one":"14","text":"block = {\n    width: 0,\n    options: options,\n    text: text,\n    lineHeight: options.lineHeight * fontObj\n    .size,\n    fontSize: fontObj.size,\n    lines: lines\n}"},"17":{"one":"18","id":"17","type":"action","text":"fontObj = parseCssFont(\n    options.font,\n    fontCache,\n    true\n)","two":""},"19":{"type":"loopend","text":"","one":"12","id":"19"},"2":{"branchId":1,"one":"5","id":"2","type":"branch","text":"Lex"},"12":{"branchId":4,"one":"32","id":"12","type":"branch","text":"Exit"},"15":{"one":"17","id":"15","type":"action","text":"setFontToTokens(lines, options.font, fontCache)","two":""},"20":{"type":"loopbegin","id":"20","one":"23","text":"line; lines"}},"updated_by":"stipan","language":"LANG_S42","type":"drakon","version":20180619,"name":"createTextBlock","created_by":"stipan"}